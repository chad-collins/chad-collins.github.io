---
import BaseHead from "../components/BaseHead.astro";
import MobileHeader from "../components/MobileHeader.astro";
import DesktopSidebar from "../components/DesktopSidebar.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { ClientRouter } from "astro:transitions";

interface Props {
	title?: string;
	description?: string;
	image?: string;
	wide?: boolean;
}

const { title = SITE_TITLE, description = SITE_DESCRIPTION, image, wide = false } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
		<ClientRouter fallback="none" />
	</head>
	<body>
		<MobileHeader transition:persist />
		<div class="layout-container">
			<DesktopSidebar transition:persist />
			<div class={`main-wrapper ${wide ? "main-wrapper--wide" : ""}`}>
				<main class="main-content">			
					<slot name="pageHeader" />
					<slot />
				</main>
				<Footer transition:persist />
			</div>
		</div>
	</body>
</html>


<style>
/* Mobile-first base styles */
:global(.desktop-sidebar) {
	display: none;
}

.layout-container {
	display: flex;
	flex-direction: column;
	min-height: 100vh;
	max-width: 100vw;
	margin: 0 auto;
	padding: 0;
}

.main-wrapper {
	display: flex;
	flex-direction: column;
	align-items: center;
	width: 100vw;
	padding-top: 0;
	overflow: hidden;
}

.main-wrapper--wide {
	max-width: none;
}

.main-content {
	width: 100%;
	max-width: 50rem;
	padding: 1rem 1.5rem 3rem;
	overflow: hidden;
}

/* Desktop: >= 1025px */
@media (width >= 1025px) {
	:global(.mobile-header),
	:global(.mobile-sidebar-overlay),
	:global(.mobile-sidebar-drawer) {
		display: none !important;
	}

	:global(.desktop-sidebar) {
		display: flex;
		flex: 1 1 auto;
		width: 18%;
		min-width: 12.5rem;
		max-width: 16rem;
		position: sticky;
		top: 0;
		height: 100vh;
		overflow-y: auto;
		padding: 1rem;
	}

	.layout-container {
		flex-direction: row;
		padding: 0 3rem;
		max-width: 90rem;
	}

	.main-wrapper {
		flex: 1 1 0;
		min-width: 0;
		border-left: 1px solid rgb(var(--border-color));
		padding-left: 3rem;
		padding-right: 3rem;
		align-items: flex-start;
	}

	.main-wrapper--wide {
		padding-right: 2rem;
	}

	.main-content {
		width: 100%;
		max-width: 50rem;
		padding-top: 1rem;
	}
}
</style>
