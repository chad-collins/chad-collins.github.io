---
import type { HTMLAttributes } from "astro/types";
import { getTagColors } from "../utils/tags";

interface Props extends HTMLAttributes<"a"> {
	variant?: "default" | "sidebar";
}

const { href, class: className, variant = "default", ...props } = Astro.props;
const pathname = Astro.url.pathname;
const isActive = href === pathname || href === "/" + pathname.split("/")[1];

// Extract section from data-section prop if it exists
const section = props["data-section"] as string | undefined;
const sectionColors = section ? getTagColors(section) : null;
const { light: sectionLightColor, dark: sectionDarkColor } = sectionColors ?? { light: null, dark: null };
---

<a
	href={href}
	class:list={[variant, isActive ? "active" : "", className]}
	style={sectionLightColor ? `--section-light: ${sectionLightColor}; --section-dark: ${sectionDarkColor};` : undefined}
	{...props}
>
	<slot />
</a>
<style>
	a.default {
		display: inline-block;
		text-decoration: none;
		padding: 20px 16px;
		color: rgb(var(--gray));
		font-weight: 400;
		font-size: 1rem;
		line-height: 1.5;
		transition: color 0.2s ease;
	}

	a.default:hover {
		color: rgb(var(--black));
	}

	a.default.active {
		color: rgb(var(--black));
		font-weight: 500;
	}

	/* Section-specific colors */
	a.default[data-section]:hover {
		color: var(--section-light);
	}

	a.default[data-section].active {
		color: var(--section-light);
		font-weight: 500;
	}

	:global([data-theme='dark']) a.default[data-section]:hover {
		color: var(--section-dark);
	}

	:global([data-theme='dark']) a.default[data-section].active {
		color: var(--section-dark);
	}
	
	/* Sidebar variant */
	a.sidebar {
		display: block;
		padding: 0.375rem 0;
		color: rgb(var(--text-color));
		text-decoration: none;
		transition: color 0.15s ease;
		font-weight: 400;
		font-size: 1rem;
		line-height: 1.5;
	}
	
	a.sidebar:hover {
		color: rgb(var(--accent));
		text-decoration: none;
	}
	
	a.sidebar.active {
		color: rgb(var(--accent));
		font-weight: 600;
	}
</style>
