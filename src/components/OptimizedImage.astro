---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
	src: string | ImageMetadata;
	alt: string;
	width?: number;
	height?: number;
}

const { src, alt, width = 800, height } = Astro.props;

// Check if it's a remote URL or local path
const isRemote = typeof src === 'string' && (src.startsWith('http://') || src.startsWith('https://'));
const isString = typeof src === 'string';
---

{isRemote ? (
	<img src={src as string} alt={alt} loading="lazy" decoding="async" />
) : isString ? (
	<img src={src} alt={alt} width={width} height={height} loading="lazy" decoding="async" />
) : (
	<Image 
		src={src} 
		alt={alt} 
		width={width}
		height={height}
		format="webp"
		quality={80}
		loading="lazy"
		decoding="async"
	/>
)}

<style>
	img, :global(img) {
		width: 100%;
		height: auto;
		border-radius: 8px;
		margin: 2em 0;
	}
</style>
